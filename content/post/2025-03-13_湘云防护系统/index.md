---
title: "湘云防护系统"
slug: "工具之一"
date: 2025-03-13
image: image01.png
description: Windows服务器安全工具
tags:
  - tool
---

# 湘云防护系统

[项目链接](https://168idc.net/)
## 项目概述

本项目旨在开发一个第三方服务器认证程序，允许用户通过手机微信扫码登录，并监控指定目录（如 C:\Windows\Fonts\）以检测隐藏文件的增加。一旦发现目录有改动，系统将发送短信提醒。

## 系统架构

### 认证模块

- **客户端**：生成包含登录请求的二维码
- **移动应用（微信）**：扫描二维码并完成认证
- **服务器端**：处理认证请求，验证用户身份，并返回认证结果

### 目录监控模块

- **监控服务**：实时监控指定目录的变化
- **通知服务**：在检测到目录变化时发送短信提醒

## 技术选型

### 认证协议

- WeChat OAuth2.0：使用微信提供的OAuth2.0接口实现安全的认证流程
- JWT (JSON Web Token)：用于生成和验证一次性令牌

### 二维码生成与解析

- Python：使用 qrcode 库生成二维码，pyzbar 解析二维码
- JavaScript：前端生成二维码，使用 qrcode.js

### 目录监控

- Python：使用 watchdog 库监控文件系统变化
- Windows API：使用 ReadDirectoryChangesW 函数进行更底层的监控

### 短信服务

- 阿里云短信服务：提供可靠的短信发送功能

### 数据库

- SQLite 或 PostgreSQL：存储用户信息、会话数据和临时令牌

## 详细实现步骤

### 认证模块

#### 1. 生成二维码

- 客户端应用程序生成一个唯一的请求ID，并将其编码到二维码中
- 将生成的二维码显示在登录页面上，供用户扫描

#### 2. 处理认证请求

- 服务器接收到带有 request_id 的认证请求后，生成一个临时令牌并存储在数据库中
- 用户通过手机微信扫描二维码后，跳转到认证页面，输入凭据或使用其他认证方式（如指纹、面部识别等）
- 认证成功后，服务器将临时令牌标记为已验证，并将认证结果返回给客户端

#### 3. 返回认证结果

- 服务器将认证结果（如JWT）返回给客户端
- 客户端使用该结果完成登录

### 目录监控模块

#### 1. 设置监控路径

- 允许管理员自定义需要监控的目录
- 默认监控路径为 C:\Windows\Fonts\

#### 2. 监控服务

- 监控文件系统变化，检测隐藏文件的增加
- 一旦检测到目录有改动，触发短信提醒

#### 3. 通知服务

- 使用阿里云短信服务发送短信提醒
